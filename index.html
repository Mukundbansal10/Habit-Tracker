<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>#1 Habit Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif}
body{background:#0e1525;color:#e5e7eb;padding:25px}
h1{text-align:center;margin-bottom:10px}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:15px;
  flex-wrap:wrap;
  gap:10px;
}

select,input,button{
  padding:8px 12px;
  border-radius:8px;
  border:none;
}

button{
  background:#22c55e;
  font-weight:600;
  cursor:pointer;
}

.dashboard{
  background:#111827;
  border-radius:16px;
  padding:15px;
  overflow-x:auto;
}

table{
  border-collapse:collapse;
  min-width:1200px;
  width:100%;
}

th,td{
  border:1px solid #1f2937;
  padding:6px;
  text-align:center;
  font-size:13px;
}

th{
  background:#1f2937;
  position:sticky;
  top:0;
}

.habit{text-align:left;font-weight:600}

.summary{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:15px;
  margin-top:20px;
}

.card{
  background:#020617;
  padding:15px;
  border-radius:12px;
}

.charts{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:20px;
  margin-top:20px;
}

footer{
  margin-top:30px;
  text-align:center;
  opacity:0.7;
}
</style>
</head>
<body>

<h1>üöÄ #1 Habit Tracker</h1>

<div class="topbar">
  <div>
    <select id="month"></select>
    <select id="year"></select>
  </div>
  <div>
    <input id="habitInput" placeholder="New habit" onkeypress="handleEnter(event)">
    <button onclick="addHabit()">Add</button>
  </div>
</div>

<div class="dashboard">
  <table id="table"></table>
</div>

<div class="summary">
  <div class="card" id="sumHabits"></div>
  <div class="card" id="sumChecks"></div>
  <div class="card" id="sumPercent"></div>
  <div class="card" id="sumBest"></div>
</div>

<div class="charts">
  <div class="card">
    <h3>üìà Daily Productivity</h3>
    <canvas id="lineChart"></canvas>
  </div>
  <div class="card">
    <h3>üìä Habit Completion</h3>
    <canvas id="barChart"></canvas>
  </div>
</div>

<footer>Developed by Mukund Bansal</footer>

<script>
const monthSelect = document.getElementById("month");
const yearSelect = document.getElementById("year");

const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
months.forEach((m,i)=>monthSelect.innerHTML+=`<option value="${i}">${m}</option>`);

for(let y=2024;y<=2030;y++) yearSelect.innerHTML+=`<option>${y}</option>`;

monthSelect.value=new Date().getMonth();
yearSelect.value=new Date().getFullYear();

let habits=[];

function key(){
  return `habits_${monthSelect.value}_${yearSelect.value}`;
}

function daysInMonth(){
  return new Date(yearSelect.value,Number(monthSelect.value)+1,0).getDate();
}

function load(){
  habits=JSON.parse(localStorage.getItem(key()))||[];
  render();
}

monthSelect.onchange=yearSelect.onchange=load;

function save(){
  localStorage.setItem(key(),JSON.stringify(habits));
  render();
}

function addHabit(){
  if(!habitInput.value.trim())return;
  habits.push({name:habitInput.value,days:Array(daysInMonth()).fill(false)});
  habitInput.value="";
  save();
}

function handleEnter(e){
  if(e.key==="Enter"){
    addHabit();
  }
}

function toggle(h,d){
  habits[h].days[d]=!habits[h].days[d];
  save();
}

function removeHabit(index){
  if(confirm("Delete this habit?")){
    habits.splice(index,1);
    save();
  }
}

function render(){
  const table=document.getElementById("table");
  table.innerHTML="";
  let days=daysInMonth();

  let head="<tr><th>Habit</th>";
  for(let i=1;i<=days;i++)head+=`<th>${i}</th>`;
  head+="<th>Total</th><th>‚ùå</th></tr>";
  table.innerHTML+=head;

  let totalChecks=0;
  habits.forEach((h,hi)=>{
    let total=h.days.filter(Boolean).length;
    totalChecks+=total;
    let row=`<tr><td class="habit">${h.name}</td>`;
    h.days.forEach((v,di)=>{
      row+=`<td><input type="checkbox" ${v?"checked":""} onclick="toggle(${hi},${di})"></td>`;
    });
    row+=`<td>${total}</td>
          <td><button onclick="removeHabit(${hi})">‚ùå</button></td>
          </tr>`;
    table.innerHTML+=row;
  });

  updateSummary(days,totalChecks);
  updateCharts(days);
}

function updateSummary(days,totalChecks){
  document.getElementById("sumHabits").innerHTML=`<h3>Total Habits</h3><p>${habits.length}</p>`;
  document.getElementById("sumChecks").innerHTML=`<h3>Total Checkmarks</h3><p>${totalChecks}</p>`;
  let percent=habits.length?Math.round(totalChecks/(habits.length*days)*100):0;
  document.getElementById("sumPercent").innerHTML=`<h3>Completion</h3><p>${percent}%</p>`;
  let best=habits.slice().sort((a,b)=>b.days.filter(Boolean).length-a.days.filter(Boolean).length)[0];
  document.getElementById("sumBest").innerHTML=`<h3>Best Habit</h3><p>${best?best.name:"‚Äî"}</p>`;
}

let line=new Chart(lineChart,{type:"line",data:{labels:[],datasets:[{data:[],borderColor:"#22c55e"}]},options:{scales:{y:{beginAtZero:true}}}});
let bar=new Chart(barChart,{type:"bar",data:{labels:[],datasets:[{data:[],backgroundColor:"#38bdf8"}]},options:{scales:{y:{beginAtZero:true}}}});

function updateCharts(days){
  let daily=[];
  for(let d=0;d<days;d++){
    let c=0;habits.forEach(h=>h.days[d]&&c++);
    daily.push(c);
  }
  line.data.labels=[...Array(days).keys()].map(d=>d+1);
  line.data.datasets[0].data=daily;
  line.update();

  bar.data.labels=habits.map(h=>h.name);
  bar.data.datasets[0].data=habits.map(h=>h.days.filter(Boolean).length);
  bar.update();
}

load();
</script>
</body>
</html>
